$("#shortlink-list").click(function(){$("#shortlink-list-view").length&&$.ajax({url:wpApiSettings.root+"dshortlink/v1/get-shortlinks/?_wpnonce="+wpApiSettings.nonce,type:"get"}).done(function(t){var e="";if("success"==t.status){var s='<table class="table">',a=t.message;$.each(a,function(t,e){var a=siteUrl+"/"+e.shortLink;s+='<tr><td><a href="'+a+'" target="_blank">'+a+"</a> - "+e.redirectLink+'</td><td class="text-right"><button class="btn btn-sm btn-primary shortlink-delete-action" shortlink-id="'+e.id+'" ><i class="fa fa-trash"></i></button></td></td></tr>'}),s+="</table>",$("#shortlink-list-view").html(s)}else e='<div class="alert alert-danger alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Error!!</strong> '+t.message+'</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>';$("#message-container").html(e)})}),$(document).on("click",".shortlink-delete-action",function(){var t={shortlinkId:$(this).attr("shortlink-id")};$.ajax({url:wpApiSettings.root+"dshortlink/v1/delete-shortlink/?_wpnonce="+wpApiSettings.nonce,data:t,type:"post"}).done(function(t){var e="";e="success"==t.status?'<div class="alert alert-success alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Success!!</strong> Shortlink deleted</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>':'<div class="alert alert-danger alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Error!!</strong> '+t.message+'</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',$("#shortlink-list").trigger("click"),$("#message-container").html(e)})}),$("#add-shortlink-form").submit(function(t){t.preventDefault();var e=$(this).serialize();$.ajax({url:wpApiSettings.root+"dshortlink/v1/add-shortlink/?_wpnonce="+wpApiSettings.nonce,data:e,type:"post"}).done(function(t){var e="";e="success"==t.status?'<div class="alert alert-success alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Success!!</strong> Shortlink created</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>':'<div class="alert alert-danger alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Error!!</strong> '+t.message+'</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',$("#message-container").html(e)})});var colors=["#5e72e4","#8965e0","#f5365c","#ffd600","#fb6340","#2dce89","#f3a4b5","#11cdef","#5603ad","#2bffc6"];function generateTotalClicksContent(t){var e=document.getElementById("shortlink-stats-total-clicks-chart").getContext("2d");new Chart(e,{type:"doughnut",data:{datasets:[{data:[t],backgroundColor:["#5e72e4"],label:"Total Clicks"}],labels:["Total Clicks"]},options:{responsive:!0,elements:{center:{text:t,color:"#5e72e4",fontStyle:"Arial",sidePadding:40}}}});$("#shortlink-stats-total-clicks-number").text(t)}function generateTodayClicksContent(t){var e=document.getElementById("shortlink-stats-today-clicks-chart").getContext("2d");new Chart(e,{type:"doughnut",data:{datasets:[{data:[t],backgroundColor:["#5e72e4"],label:"Today Clicks"}],labels:["Today Clicks"]},options:{responsive:!0,elements:{center:{text:t,color:"#5e72e4",fontStyle:"Arial",sidePadding:40}}}});$("#shortlink-stats-today-clicks-number").text(t)}function generateByClicksContent(t){var e=[],s=[],a=[],n="";$.each(t,function(t,r){e.push(r.clicks),s.push(r.shortLink),a.push(colors[t%10]),n+="<tr><td>"+(t+1)+"</td><td>"+r.shortLink+"</td><td>"+r.clicks+"</td></tr>"});var r=document.getElementById("shortlink-stats-by-clicks-chart").getContext("2d");new Chart(r,{type:"doughnut",data:{datasets:[{data:e,backgroundColor:a}],labels:s},options:{responsive:!0}});$("#shortlink-stats-by-clicks-table tbody").html(n)}function generateByRefererContent(t){var e=[],s=[],a=[],n="";$.each(t,function(t,r){e.push(r.clicks),s.push(r.referer),a.push(colors[t%10]),n+="<tr><td>"+(t+1)+"</td><td>"+r.referer+"</td><td>"+r.clicks+"</td></tr>"});var r=document.getElementById("shortlink-stats-by-referer-chart").getContext("2d");new Chart(r,{type:"doughnut",data:{datasets:[{data:e,backgroundColor:a}],labels:s},options:{responsive:!0}});$("#shortlink-stats-by-referer-table tbody").html(n)}function generateByCountryContent(t){var e=[],s=[],a=[],n="";$.each(t,function(t,r){e.push(r.clicks),s.push(r.country),a.push(colors[t%10]),n+="<tr><td>"+(t+1)+"</td><td>"+r.country+"</td><td>"+r.clicks+"</td></tr>"});var r=document.getElementById("shortlink-stats-by-country-chart").getContext("2d");new Chart(r,{type:"doughnut",data:{datasets:[{data:e,backgroundColor:a}],labels:s},options:{responsive:!0}});$("#shortlink-stats-by-country-table tbody").html(n)}$("#shortlink-dashboard").length&&$.ajax({url:wpApiSettings.root+"dshortlink/v1/get-stats/?_wpnonce="+wpApiSettings.nonce,type:"get"}).done(function(t){var e="";if("success"==t.status){var s=t.message.totalClicks[0].clicks,a=t.message.todayClicks[0].clicks,n=t.message.byClicks,r=t.message.byReferer,o=t.message.byCountry;generateTotalClicksContent(s),generateTodayClicksContent(a),generateByClicksContent(n),generateByRefererContent(r),generateByCountryContent(o)}else e='<div class="alert alert-danger alert-dismissible fade show" role="alert"><span class="alert-inner--text"><strong>Error!!</strong> '+t.message+'</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>';$("#message-container").html(e)});